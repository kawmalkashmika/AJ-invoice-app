<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link href="bootstrap-5.3.3-dist/css/bootstrap.min.css" rel="stylesheet">
    <title>Invoice Service</title>
    <style>
        .bg-image {
            background-image: url('background.jpg'); /* Replace with your image URL */
            background-size: cover;
            background-position: center;
            height: 100vh; /* Full-screen height */
            color: white; /* Optional: Make text readable */
        }
    </style>
</head>
<body>
<div class="bg-image d-flex align-items-center justify-content-center">
    <div class="container" style="border: 2px black solid; background: rgba(255, 255, 255, 0.8); padding: 20px; border-radius: 8px;">
        <div class="row mb-3">
            <div class="col-12">
                <h1 class="text-center">Asanka Transport Solutions Invoice Service</h1>
            </div>
        </div>
        <!-- Invoice Number and Date -->
        <div class="row mb-3">
            <div class="col-md-7">
                <input id="invoiceNumber" type="number" placeholder="Invoice Number" class="form-control" required>
            </div>
            <div class="col-md-5">
                <input id="invoiceDate" type="date" class="form-control">
            </div>
        </div>
        <!-- Customer Name -->
        <div class="row mb-3">
            <div class="col-12">
                <input id="customerName" type="text" placeholder="Customer Name" class="form-control" required>
            </div>
        </div>
        <!-- Item Entry -->
        <div class="row mb-3">
            <div class="col-2">
                <input type="number" id="qty" placeholder="Qty" class="form-control">
            </div>
            <div class="col-4">
                <input type="text" id="desc" placeholder="Description" class="form-control">
            </div>
            <div class="col-4">
                <input type="number" id="unitPrice" placeholder="Unit Price" class="form-control">
            </div>
            <div class="col-2">
                <button type="button" id="btnAdd" class="btn btn-success">+</button>
            </div>
        </div>
        <!-- Invoice Items Table -->
        <div id="tableContainer" style="display: none;">
            <div class="row">
                <div class="col-12">
                    <table class="table table-bordered table-striped table-hover bg-white">
                        <thead>
                        <tr>
                            <th>Qty</th>
                            <th>Description</th>
                            <th>Unit Price (€)</th>
                            <th>Action</th>
                        </tr>
                        </thead>
                        <tbody id="invoiceTable">
                        <!-- Rows will be added here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- Total -->
            <div class="row">
                <div class="col-12 text-end">
                    <h4>Total: <span id="totalAmount">0.00</span> €</h4>
                </div>
            </div>
        </div>
        <!-- Print Button -->
        <div class="row mt-3">
            <div class="col-12 text-end">
                <button id="btnPrint" class="btn btn-primary">Print</button>
            </div>
        </div>
    </div>
</div>

<script>
    const tableContainer = document.getElementById("tableContainer");
    const invoiceTable = document.getElementById("invoiceTable");
    const totalAmount = document.getElementById("totalAmount");
    const btnPrint = document.getElementById("btnPrint");

    // Function to update the total amount
    function updateTotal() {
        let total = 0;
        const rows = document.querySelectorAll("#invoiceTable tr");
        rows.forEach(row => {
            const qty = parseFloat(row.querySelector(".qty").textContent);
            const unitPrice = parseFloat(row.querySelector(".unitPrice").textContent);
            total += qty * unitPrice;
        });
        totalAmount.textContent = total.toFixed(2);
    }

    // Toggle table visibility based on rows
    function toggleTableVisibility() {
        if (invoiceTable.children.length > 0) {
            tableContainer.style.display = "block";
        } else {
            tableContainer.style.display = "none";
        }
    }

    // Add row functionality
    document.getElementById("btnAdd").addEventListener("click", function () {
        // Get input values
        const qty = document.getElementById("qty").value;
        const desc = document.getElementById("desc").value;
        const unitPrice = document.getElementById("unitPrice").value;

        // Validate inputs
        if (!qty || !desc || !unitPrice || qty <= 0 || unitPrice <= 0) {
            alert("Please fill in all fields with valid values before adding.");
            return;
        }

        // Create a new table row
        const row = document.createElement("tr");

        // Add columns to the row
        row.innerHTML = `
            <td class="qty">${qty}</td>
            <td>${desc}</td>
            <td class="unitPrice">${unitPrice}</td>
            <td>
                <button type="button" class="btn btn-danger btn-sm btnRemove">Remove</button>
            </td>
        `;

        // Append the row to the table
        invoiceTable.appendChild(row);

        // Clear input fields
        document.getElementById("qty").value = "";
        document.getElementById("desc").value = "";
        document.getElementById("unitPrice").value = "";

        // Add event listener for the remove button
        row.querySelector(".btnRemove").addEventListener("click", function () {
            invoiceTable.removeChild(row);
            updateTotal();
            toggleTableVisibility();
        });

        // Update the total amount and toggle visibility
        updateTotal();
        toggleTableVisibility();
    });

    // Print functionality
    btnPrint.addEventListener("click", function () {
        const invoiceDetails = `
            <html>
                <head>
                    <title>Invoice</title>
                </head>
                <body>
                    <h1>Invoice</h1>
                    <p>Invoice Number: ${document.getElementById("invoiceNumber").value}</p>
                    <p>Date: ${document.getElementById("invoiceDate").value}</p>
                    <p>Customer Name: ${document.getElementById("customerName").value}</p>
                    <table border="1" style="width: 100%; border-collapse: collapse;">
                        <thead>
                            <tr>
                                <th>Qty</th>
                                <th>Description</th>
                                <th>Unit Price (€)</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${Array.from(invoiceTable.children).map(row => `
                                <tr>
                                    <td>${row.querySelector(".qty").textContent}</td>
                                    <td>${row.querySelector("td:nth-child(2)").textContent}</td>
                                    <td>${row.querySelector(".unitPrice").textContent}</td>
                                </tr>
                            `).join("")}
                        </tbody>
                    </table>
                    <h3>Total: ${totalAmount.textContent} €</h3>
                </body>
            </html>
        `;

        const printWindow = window.open("", "_blank");
        printWindow.document.open();
        printWindow.document.write(invoiceDetails);
        printWindow.document.close();
        printWindow.print();
    });
</script>
<script src="bootstrap-5.3.3-dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
